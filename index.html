<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=0.7">
    <title>3B Schedule</title>
    <script>
        class Day{
            constructor(day){
                this.day = day;
                this.subjects = [];
                this.title;
            }
        }

        class Time{
            constructor(hour, minute,second = 0, day = 0){
                this.day = day;
                this.hour = hour;
                this.minute = minute;
                this.second = second;
            }
        }


        class Subject{
            constructor(element){
                this.element = element;
                this.start = new Time() , this.end = new Time();
                this.status;
                for(var i = 0; i < element.children.length; i++){
                    if(element.children[i].classList.contains('status')){
                        this.status = element.children[i];
                    }
                    if(element.children[i].classList.contains('time')){
                        var html = element.children[i].innerHTML;
                        this.start.hour =  parseInt(html[0] + '' + html[1]);
                        if(html[6] +'' + html[7] == 'PM' && this.start.hour !=12 ) this.start.hour += 12;
                        this.start.minute =  parseInt(html[3] + '' + html[4]);
                        
                        this.end.hour =  parseInt(html[9] + '' + html[10]);
                        if(html[15] +'' + html[16] == 'PM' && this.end.hour != 12) this.end.hour += 12;
                        this.end.minute =  parseInt(html[12] + '' + html[13]);
                    }
                }
            }
        }

        function solveMinutes(time1, time2){
            var hour = time1.hour - time2.hour;
            return (time1.minute + (60 * hour) ) - time2.minute

        }
        function classOngoing(time1, time2){
            var hour = time1.hour - time2.hour;
            var minute  =  (time1.minute + (60 * hour) ) - time2.minute
            var seconds = (time1.second + (60 * minute) ) - time2.second
            
            return Math.floor((seconds/60)/60).toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false}) + ':' + Math.floor((seconds/60)%60).toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false}) + ":" + (seconds%60).toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false});
        }
        
        function countdown(time1, time2){
            var day = time1.day - time2.day;
            var hour = time1.hour + (24 * day) - time2.hour;
            var minute  =  (time1.minute + (60 * hour) ) - time2.minute
            var seconds = (time1.second + (60 * minute) ) - time2.second
            
            return  Math.floor(((seconds/60)/60)/24).toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false}) + ':'+ Math.floor(((seconds/60)/60)%60).toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false}) + ':' + Math.floor((seconds/60)%60).toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false}) + ":" + (seconds%60).toLocaleString('en-US', {minimumIntegerDigits: 2, useGrouping:false});
        }
    

        window.onload = () => { 

            var schedList = [];
            var temp = document.getElementsByClassName('mon');
            var monList = new Day(1);
            for (var i = 0; i < temp.length; i++){
                monList.subjects.push(new Subject(temp[i]));
            }
            temp = document.getElementsByClassName('tue');
            var tueList = new Day(2);
            for (var i = 0; i < temp.length; i++){
                tueList.subjects.push(new Subject(temp[i]));
            }
            temp = document.getElementsByClassName('wed');
            var wedList = new Day(3);
            for (var i = 0; i < temp.length; i++){
                wedList.subjects.push(new Subject(temp[i]));
            }
            temp = document.getElementsByClassName('thu');
            var thuList = new Day(4);
            for (var i = 0; i < temp.length; i++){
                thuList.subjects.push(new Subject(temp[i]));
            }
            temp = document.getElementsByClassName('fri');
            var friList = new Day(5);
            for (var i = 0; i < temp.length; i++){
                friList.subjects.push(new Subject(temp[i]));
            }

            monList.title = document.getElementById('monday');
            tueList.title = document.getElementById('tuesday');
            wedList.title = document.getElementById('wednesday');
            thuList.title = document.getElementById('thursday');
            friList.title = document.getElementById('friday');
            
            schedList.push(monList);
            schedList.push(tueList);
            schedList.push(wedList);
            schedList.push(thuList);
            schedList.push(friList);

            

            var loop = setInterval( () =>{
                var currentDate = new Date();
                var activeClass, currentTime = new Time(currentDate.getHours(), currentDate.getMinutes() , currentDate.getSeconds(), currentDate.getDay());
                for(var i = 0 ; i < schedList.length; i++){
                    if(schedList[i].day == currentDate.getDay() ){
                        schedList[i].title.classList.add('classDismissedToday');
                        for(var j = 0; j < schedList[i].subjects.length; j++){
                            if(solveMinutes (schedList[i].subjects[j].end, currentTime) <= 0)  {
                                schedList[i].subjects[j].status.innerHTML = 'Class Dismissed';
                                activeClass = schedList[i].subjects[j].element.children;
                                for(var k = 0 ; k < activeClass.length; k++){
                                    activeClass[k].classList.add('classDismissedToday');
                                    if(activeClass[k].classList.contains('classOngoing')) activeClass[k].classList.remove('classOngoing');
                                }
                            }
                            else if( solveMinutes(currentTime , schedList[i].subjects[j].start) >= 0 && solveMinutes (schedList[i].subjects[j].end, currentTime) > 0) {
                                schedList[i].subjects[j].status.innerHTML = 'Class Ongoing (' + classOngoing (schedList[i].subjects[j].end, currentTime)+')' ;
                                activeClass = schedList[i].subjects[j].element.children;
                                for(var k = 0 ; k < activeClass.length; k++){
                                    activeClass[k].classList.add('classOngoing');
                                }
                            }else{
                                activeClass = schedList[i].subjects[j].element.children;
                                for(var k = 0 ; k < activeClass.length; k++){
                                    if(activeClass[k].classList.contains('classOngoing')) activeClass[k].classList.remove('classOngoing');
                                    if(activeClass[k].classList.contains('classDismissed')) activeClass[k].classList.remove('classDismissed');
                                    if(activeClass[k].classList.contains('classDismissedToday'))activeClass[k].classList.add('classDismissedToday');
                                }
                                if(schedList[i].title.classList.contains('classDismissed'))schedList[i].title.classList.remove('classDismissed');
                                if(schedList[i].title.classList.contains('laterClass')) schedList[i].title.classList.remove('laterClass');
                                schedList[i].subjects[j].start.day = schedList[i].day;
                                schedList[i].subjects[j].status.innerHTML = '' + countdown (schedList[i].subjects[j].start, currentTime)+'' ;
                            }
                        }
                    }
                    else if(schedList[i].day > currentDate.getDay()){
                        for(var j = 0; j < schedList[i].subjects.length;j++){
                            schedList[i].subjects[j].start.day = schedList[i].day;
                            schedList[i].subjects[j].status.innerHTML = '' + countdown (schedList[i].subjects[j].start, currentTime)+'' ;
                            activeClass = schedList[i].subjects[j].element.children;
                            for(var k = 0 ; k < activeClass.length; k++){
                                activeClass[k].classList.add('laterClass');
                            }
                            schedList[i].title.classList.add('laterClass');
                        }
                    }
                    else if(currentDate.getDay() == 0){
                        for(var j = 0; j < schedList[i].subjects.length;j++){
                            activeClass = schedList[i].subjects[j].element.children;
                            for(var k = 0 ; k < activeClass.length; k++){
                                if(activeClass[k].classList.contains('classOngoing')) activeClass[k].classList.remove('classOngoing');
                                if(activeClass[k].classList.contains('classDismissed')) activeClass[k].classList.remove('classDismissed');
                                if(activeClass[k].classList.contains('classDismissedToday'))activeClass[k].classList.add('classDismissedToday');
                            }
                            if(schedList[i].title.classList.contains('classDismissed'))schedList[i].title.classList.remove('classDismissed');
                            schedList[i].subjects[j].start.day = schedList[i].day;
                            schedList[i].subjects[j].status.innerHTML = '' + countdown (schedList[i].subjects[j].start, currentTime)+'' ;
                        }
                    }else if(schedList[i].day < currentDate.getDay()){
                        schedList[i].title.classList.add('classDismissed');
                        for(var j = 0 ; j < schedList[i].subjects.length; j++){
                            schedList[i].subjects[j].status.innerHTML = "Class Dismissed";
                            activeClass = schedList[i].subjects[j].element.children;
                            for(var k = 0 ; k < activeClass.length; k++){
                                if(activeClass[k].classList.contains('classOngoing')) activeClass[k].classList.remove('classOngoing');
                                activeClass[k].classList.add('classDismissed');
                            }
                        }
                    }


                    if(currentDate.getDay() == 6){
                        document.getElementById('sched').classList.add('classDismissed');
                        document.getElementById('sched').innerHTML = "WEEKEND";
                    }else {
                        if(document.getElementById('sched').classList.contains('classDismissed'))document.getElementById('sced').classList.remove('classDismissed');
                        if(document.getElementById('sched').innerHTML != "SCHEDULE")document.getElementById('sched').innerHTML = "SCHEDULE";
                    }
                }
            } , 1)
        }
    </script>
    <style>
        body{
            background-color: rgb(26, 25, 27);
            display: block;
            text-align: center;
            margin: 0;
        }
        .schedContainer{
            display:block;
            margin: auto;   
            max-width:70%;
            justify-content: center;
        }
        .row{
            display: flex;
            height: 45px;
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 20px;
        }
        .col{
            background-color: rgb(241, 255, 250);
            display: flex;
            border-style: solid;
            border-width: 1px;
            border-color: black;
            width: 200px;
            min-width: 100px;
            height: 60px;
            justify-content: center;
            text-align: center;
            align-items: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 32px;
            border-radius: 5px;
            
        }
        .title{
            display: flex;
            width: 80%;
            font-size: 27px;
            letter-spacing: 10px;
            max-width: 980px;
            min-width: 300px;
            margin: auto;
            height: 60px;
            background-color: rgb(241, 255, 250);
            
        }
        .dayTitle{
            display: flex;
            width: 70%;
            max-width: 960px;
            min-width: 400px;
            font-size: 17px;
            text-align: center;
            justify-content: center;
            align-items: center;
            letter-spacing: 30px;
            margin-left: auto;
            margin-right: auto;
            height: 40px;
            
        }
        .items{
            font-size: 13px;
            word-wrap: break-word;
        }
        .label{
            height: 30px;
            background-color: rgb(63, 63, 63);
            color: white;
        }

        .extra{
            background-color: rgb(26, 25, 27);
            border: none;
        }

        .classDismissed{
            background-color: rgb(63, 63, 63);
            color: white;
        }
        .classDismissedToday{
            background-color: rgb(226, 250, 207);
            
        }
        .classOngoing{
            background-color: greenyellow;
        }

        .laterClass{
           
        }

        @media screen and (max-width: 890px) {
           .items{
                font-size: 10px;
           }
           
         }
         @media screen and (max-width: 600px) {
        
            .dayTitle, .title{
                width: 100%;
           }
            .schedContainer{
                margin: 0px;
                max-width: 630px;
                width: 630px;
            }
           
         }
    </style>
</head>
<body>
    <div class="schedContainer">
        
        <div class="row"style="margin-bottom: 30px;" >
            <div class="col title" id="sched" > SCHEDULE </div>
        </div>
        <div class="row" style="margin-bottom: 0px;"> 
            <div class="col items label codeL"> CODE </div>
            <div class="col items label subjectL"> SUBJECT </div>
            <div class="col items label timeL"> TIME</div>
            <div class="col items label roomL"> ROOM</div>
            <div class="col items label facultyL">FACULTY</div>
            <div class="col items label statusL">STATUS</div>
        </div>
        <div class="row" style="margin-bottom: 10px;">
            <div class="col dayTitle" id="monday"> MONDAY</div>
        </div>


        <div class="row mon"> 
            <div class="col items code"> CS 114 </div>
            <div class="col items subject"> Operating Systems </div>

            <div class="col items time">01:00 PM-04:00 PM</div>
            <div class="col items room"> CS-02-204</div>
            <div class="col items faculty">BURCE, M.</div>
            <div class="col items status">--</div>

        </div>
        <div class="row mon"style="margin-bottom: 30px;"> 
            <div class="col items code"> CS 115</div>
            <div class="col items subject"> Computer Architecture And Organization </div>
            <div class="col items time">05:30 PM-07:30 PM</div>
            <div class="col items room"> CS-04-208</div>
            <div class="col items faculty">-----</div>
            <div class="col items status">--</div>
        </div>
        <div class="row" style="margin-bottom: 10px;">
            <div class="col dayTitle" id="tuesday" > TUESDAY</div>
        </div>
        <div class="row tue"> 
            <div class="col items code"> CS 117 </div>
            <div class="col items subject"> Software Engineering 1 </div>
            <div class="col items time">09:00 AM-12:00 PM</div>
            <div class="col items room"> CS-02-204  </div>
            <div class="col items faculty">MACEDA, L.</div>
            <div class="col items status">--</div>
        </div>
        <div class="row tue"> 
            <div class="col items code"> CS Elec 1  </div>
            <div class="col items subject"> Cs Elec 1  </div>
            <div class="col items time">01:00 PM-04:00 PM </div>
            <div class="col items room"> CS-04-204  </div>
            <div class="col items faculty">SATUITO, A. </div>
            <div class="col items status">--</div>
        </div>
        <div class="row tue"> 
            <div class="col items code"> CS 116   </div>
            <div class="col items subject">  Automata Theory And Formal Languages </div>
            <div class="col items time">05:30 PM-07:00 PM  </div>
            <div class="col items room"> CS TBA RM14  </div>
            <div class="col items faculty">MENDONES, R. </div>
            <div class="col items status">--</div>
        </div>
        <div class="row tue"style="margin-bottom: 30px;"> 
            <div class="col items code"> GEC 16 </div>
            <div class="col items subject">  Art Appreciation  </div>
            <div class="col items time">07:00 PM-08:30 PM  </div>
            <div class="col items room"> CAL TBA24 </div>
            <div class="col items faculty"> ----- </div>
            <div class="col items status">--</div>
        </div>
        <div class="row" style="margin-bottom: 10px;">
            <div class="col dayTitle" id="wednesday" > WEDNESDAY</div>
        </div>
        <div class="row wed"> 
            <div class="col items code"> CS 117 </div>
            <div class="col items subject"> Software Engineering 1 </div>
            <div class="col items time">08:00 AM-10:00 AM</div>
            <div class="col items room"> CS-04-201 </div>
            <div class="col items faculty">MACEDA, L.</div>
            <div class="col items status">--</div>
        </div>
        <div class="row wed"style="margin-bottom: 30px;"> 
            <div class="col items code"> CS 114 </div>
            <div class="col items subject"> Operating Systems </div>
            <div class="col items time">01:00 PM-04:00 PM</div>
            <div class="col items room"> CS-02-204</div>
            <div class="col items faculty">BURCE, M.</div>
            <div class="col items status">--</div>
        </div>

        <div class="row" style="margin-bottom: 10px;">
            <div class="col dayTitle" id="thursday" > THURSDAY</div>
        </div>
        <div class="row thu"> 
            <div class="col items code"> CS 117 </div>
            <div class="col items subject"> Software Engineering 1 </div>
            <div class="col items time">09:00 AM-12:00 PM</div>
            <div class="col items room"> CS-02-204 </div>
            <div class="col items faculty">MACEDA, L.</div>
            <div class="col items status">--</div>
        </div>
        <div class="row thu"> 
            <div class="col items code"> Fil 21  </div>
            <div class="col items subject"> Kontekstwalisadong Komunikasyon Sa Filipino (Komfil) </div>
            <div class="col items time">01:00 PM-04:00 PM</div>
            <div class="col items room"> CAL TBA20</div>
            <div class="col items faculty"> GAMBOA, M.</div>
            <div class="col items status">--</div>
        </div>
        <div class="row thu"> 
            <div class="col items code"> CS 116  </div>
            <div class="col items subject">  Automata Theory And Formal Languages </div>
            <div class="col items time">05:30 PM-07:00 PM  </div>
            <div class="col items room"> CS TBA RM14  </div>
            <div class="col items faculty">MENDONES, R. </div>
            <div class="col items status">--</div>
        </div>
        <div class="row thu" style="margin-bottom: 30px;"> 
            <div class="col items code"> GEC 16 </div>
            <div class="col items subject">  Art Appreciation  </div>
            <div class="col items time">07:00 PM-08:30 PM  </div>
            <div class="col items room"> CAL TBA24 </div>
            <div class="col items faculty"> ----- </div>
            <div class="col items status">--</div>
        </div>
        <div class="row" style="margin-bottom: 10px;">
            <div class="col dayTitle" id="friday" > FRIDAY</div>
        </div>
        <div class="row fri" style="margin-bottom: 30px;"> 
            <div class="col items code"> CS 114 </div>
            <div class="col items subject"> Operating Systems </div>
            <div class="col items time">04:00 PM-06:00 PM </div>
            <div class="col items room"> CS-02-204</div>
            <div class="col items faculty">BURCE, M.</div>
            <div class="col items status" >--</div>
        </div>

        <div class="row" style="margin-bottom: 30px;">
            <div class="col dayTitle extra" ></div>
        </div>
    </div>
</body>
</html>